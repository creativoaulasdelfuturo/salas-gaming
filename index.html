<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Gaming - Almacenamiento Local</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon-blue: #00f2ff; --neon-purple: #bc13fe; --dark-bg: #0d0d15; }
        body { background-color: var(--dark-bg); color: #e0e0e0; font-family: 'Rajdhani', sans-serif; }
        .font-gaming { font-family: 'Orbitron', sans-serif; }
        .neon-border { border: 1px solid var(--neon-blue); box-shadow: 0 0 10px rgba(0, 242, 255, 0.3); }
        .phase-badge { padding: 4px; border-radius: 4px; font-size: 0.7rem; text-transform: uppercase; width: 100%; cursor: pointer; border: none; outline: none; transition: all 0.2s; }
        .status-espera { background: #374151; color: #d1d5db; }
        .status-aceptado { background: #2563eb; color: white; box-shadow: 0 0 5px #2563eb; }
        .status-rechazado { background: #dc2626; color: white; box-shadow: 0 0 5px #dc2626; }
        
        /* Pantalla de carga con LOGO 04.jpg */
        #loading-overlay { 
            background: #0d0d15; 
            z-index: 1000; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            position: fixed; 
            inset: 0; 
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .loading-hidden { opacity: 0; visibility: hidden; pointer-events: none; }

        .logo-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto 24px;
        }

        .logo-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            position: relative;
            z-index: 10;
            filter: drop-shadow(0 0 15px rgba(0, 242, 255, 0.4));
        }

        /* Efecto de brillo circular detr√°s del logo */
        .logo-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 140%;
            height: 140%;
            background: radial-gradient(circle, rgba(0, 242, 255, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            animation: pulse-glow 3s infinite ease-in-out;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 0.4; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.05); }
        }

        @keyframes loading-bar {
            0% { width: 0%; transform: translateX(-100%); }
            50% { width: 100%; transform: translateX(0%); }
            100% { width: 0%; transform: translateX(100%); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Pantalla de Carga Est√©tica con Logo 04.jpg -->
    <div id="loading-overlay">
        <div class="text-center">
            <div class="logo-container">
                <div class="logo-glow"></div>
                <!-- Usando la imagen 04.jpg proporcionada -->
                <img src="04.jpg" alt="Logo Gaming" class="logo-img" onerror="this.style.display='none'; document.getElementById('fallback-spinner').style.display='block';">
                
                <!-- Spinner de respaldo -->
                <div id="fallback-spinner" class="hidden w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto"></div>
            </div>
            <p class="font-gaming text-cyan-400 text-sm animate-pulse tracking-[0.3em] uppercase">Sincronizando Interfaz</p>
            <div class="w-64 h-1 bg-gray-800 mx-auto mt-6 rounded-full overflow-hidden border border-cyan-900/30">
                <div class="h-full bg-cyan-500 animate-[loading-bar_2s_ease-in-out_infinite]"></div>
            </div>
        </div>
    </div>

    <header class="max-w-7xl mx-auto mb-8 flex justify-between items-center border-b border-cyan-900 pb-4">
        <div>
            <h1 class="text-xl font-gaming text-cyan-400">GAMING CRM <span class="text-[10px] text-purple-500">[LOCAL MODE]</span></h1>
            <p class="text-[10px] text-gray-400 uppercase tracking-widest">Base de datos privada activa</p>
        </div>
        <div class="text-right">
            <p id="clock" class="text-lg font-gaming text-white">00:00:00</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-6">
        <aside class="lg:col-span-1">
            <form id="client-form" class="neon-border p-4 bg-black/40 rounded-lg space-y-4">
                <h2 class="font-gaming text-xs text-purple-400 uppercase mb-2 border-b border-purple-900/50 pb-2">Registrar Lead</h2>
                <div>
                    <label class="text-[9px] uppercase text-gray-500 mb-1 block">Nombre Contacto</label>
                    <input type="text" id="contact_name" required class="w-full p-2 rounded text-sm bg-white/5 border border-cyan-900 outline-none focus:border-cyan-400 transition-colors" placeholder="Ej: John Doe">
                </div>
                <div>
                    <label class="text-[9px] uppercase text-gray-500 mb-1 block">Empresa / Proyecto</label>
                    <input type="text" id="company_name" required class="w-full p-2 rounded text-sm bg-white/5 border border-cyan-900 outline-none focus:border-cyan-400 transition-colors" placeholder="Ej: Cyberpunk Devs">
                </div>
                <button type="submit" class="w-full py-3 bg-cyan-950 hover:bg-cyan-600 text-cyan-400 hover:text-white border border-cyan-500 font-gaming text-[10px] rounded transition-all uppercase tracking-widest">A√±adir a Memoria</button>
            </form>
            
            <div class="mt-4 p-3 border border-gray-800 rounded bg-black/40 text-[9px] text-gray-500 leading-relaxed">
                <p>üîí Los datos se almacenan localmente en tu navegador. <br> No se comparten con servidores externos.</p>
            </div>
        </aside>

        <section class="lg:col-span-3">
            <div class="neon-border bg-black/60 rounded-lg overflow-hidden h-[600px] flex flex-col">
                <div class="p-4 bg-slate-900/50 border-b border-cyan-900 flex items-center justify-between gap-4">
                    <div class="flex-grow relative">
                        <input type="text" id="search-input" placeholder="BUSCAR LEAD..." class="bg-black/40 border border-cyan-900 text-[10px] px-3 py-2 rounded w-full outline-none focus:border-cyan-400 tracking-widest">
                    </div>
                    <span id="counter" class="text-[10px] font-gaming text-cyan-500 whitespace-nowrap">DB SIZE: 0</span>
                </div>
                <div class="overflow-auto flex-grow">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-black text-[9px] text-gray-500 uppercase sticky top-0 z-10">
                            <tr>
                                <th class="p-4 border-b border-gray-800">Identidad</th>
                                <th class="p-4 text-center border-b border-gray-800">Fase 1</th>
                                <th class="p-4 text-center border-b border-gray-800">Fase 2</th>
                                <th class="p-4 text-center border-b border-gray-800">Fase 3</th>
                                <th class="p-4 border-b border-gray-800">Notas</th>
                                <th class="p-4 text-right border-b border-gray-800">Acci√≥n</th>
                            </tr>
                        </thead>
                        <tbody id="client-list">
                            <!-- Datos inyectados por JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <script>
        let leads = JSON.parse(localStorage.getItem('crm_gaming_leads_v2')) || [];

        // Inicializaci√≥n
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loading-overlay').classList.add('loading-hidden');
                renderLeads();
            }, 1800); 
        });

        // Reloj tiempo real
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }, 1000);

        function renderLeads() {
            const list = document.getElementById('client-list');
            const term = document.getElementById('search-input').value.toLowerCase();
            const counter = document.getElementById('counter');
            
            const filtered = leads.filter(l => 
                l.contact_name.toLowerCase().includes(term) || 
                l.company_name.toLowerCase().includes(term)
            ).sort((a,b) => b.createdAt - a.createdAt);

            counter.innerText = `DB SIZE: ${filtered.length}`;

            if (filtered.length === 0) {
                list.innerHTML = '<tr><td colspan="6" class="p-10 text-center text-gray-600 uppercase text-[10px] tracking-[0.3em]">Memoria Vac√≠a / No Resultados</td></tr>';
                return;
            }

            list.innerHTML = filtered.map(l => `
                <tr class="border-b border-gray-800 hover:bg-cyan-500/5 transition-colors group">
                    <td class="p-4">
                        <div class="font-bold text-white text-xs uppercase tracking-tighter">${l.contact_name}</div>
                        <div class="text-[9px] text-cyan-600 tracking-widest font-medium">${l.company_name}</div>
                    </td>
                    ${['f1','f2','f3'].map(f => `
                        <td class="p-4 text-center">
                            <select onchange="updateField('${l.id}', '${f}', this.value)" class="phase-badge status-${l[f] || 'espera'}">
                                <option value="espera" ${l[f]==='espera'?'selected':''}>‚è≥ ESPERA</option>
                                <option value="aceptado" ${l[f]==='aceptado'?'selected':''}>‚úÖ VISTO</option>
                                <option value="rechazado" ${l[f]==='rechazado'?'selected':''}>‚ùå NULO</option>
                            </select>
                        </td>
                    `).join('')}
                    <td class="p-4">
                        <input type="text" onblur="updateField('${l.id}', 'notes', this.value)" value="${l.notes || ''}" 
                        class="bg-transparent border-b border-gray-800 text-[10px] w-full outline-none focus:border-cyan-500 text-gray-400"
                        placeholder="A√±adir nota...">
                    </td>
                    <td class="p-4 text-right">
                        <button onclick="deleteLead('${l.id}')" class="text-gray-700 hover:text-red-500 transition-colors font-bold text-xl px-2">√ó</button>
                    </td>
                </tr>
            `).join('');
        }

        document.getElementById('client-form').onsubmit = (e) => {
            e.preventDefault();
            const newLead = {
                id: Date.now().toString(),
                contact_name: document.getElementById('contact_name').value,
                company_name: document.getElementById('company_name').value,
                f1: 'espera', f2: 'espera', f3: 'espera',
                notes: '',
                createdAt: Date.now()
            };
            leads.push(newLead);
            saveAndRender();
            e.target.reset();
        };

        window.updateField = (id, field, val) => {
            const index = leads.findIndex(l => l.id === id);
            if (index !== -1) {
                leads[index][field] = val;
                saveAndRender();
            }
        };

        window.deleteLead = (id) => {
            if (confirm("¬øEliminar este registro permanentemente?")) {
                leads = leads.filter(l => l.id !== id);
                saveAndRender();
            }
        };

        function saveAndRender() {
            localStorage.setItem('crm_gaming_leads_v2', JSON.stringify(leads));
            renderLeads();
        }

        document.getElementById('search-input').oninput = renderLeads;
    </script>
</body>
</html>